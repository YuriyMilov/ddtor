
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyB2pOjn8eiMkoMEGZET4tdFiDzsaJqPjn8&sensor=false"></script>
<script type="text/javascript">
var directionDisplay;
var map; 
function initialize() {
    directionsDisplay = new google.maps.DirectionsRenderer();
    var melbourne = new google.maps.LatLng(43.55, -79.55);
    var myOptions = {
    zoom:10,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    center: melbourne
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    directionsDisplay.setMap(map);
}
var directionsService = new google.maps.DirectionsService();

function calcRoute() {
    var start = document.getElementById("start").value;
    var end = document.getElementById("end").value;
    var im1 = document.getElementById("im1").value;
    var im2 = document.getElementById("im2").value;
    var im3 = document.getElementById("im3").value;

    var waypoints = [{
          location:im1,
          stopover:true
      },{
          location:im2,
          stopover:true
      },{
          location:im3,
          stopover:true
      }];

    var request = {
    origin:start,
    destination:end,
    waypoints: waypoints,
    optimizeWaypoints: true,
    travelMode: google.maps.DirectionsTravelMode.DRIVING
    };
    directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      var distanceInput = document.getElementById("distance");
      distanceInput.value = response.routes[0].legs[0].distance.value / 1000 + response.routes[0].legs[1].distance.value / 1000 + response.routes[0].legs[2].distance.value / 1000 + response.routes[0].legs[3].distance.value / 1000;
      directionsDisplay.setDirections(response);
    } else {
      alert("Directions request failed: "+status);
    }
    });
}
</script>
<title>Distance Calculator</title>
<style type="text/css">
#map_canvas {
height: 70%;
}
</style>
</head>
<body onload="initialize()">
<div>
<p>
<label for="start">Start: </label>
<input type="text" name="start" id="start" value="oakville"/>

<label for="end">End: </label>
<input type="text" name="end" id="end" value="mississauga"/>

<label for="im1">Intermediate Point 1: </label>
<input type="text" name="im1" id="im1" value="toronto"/>

<label for="im2">Intermediate Point 2: </label>
<input type="text" name="im2" id="im2" value="milton"/>

<label for="im3">Intermediate Point 3: </label>
<input type="text" name="im3" id="im3" value="brampton"/>

<input type="submit" value="Calculate Route" onclick="calcRoute()" />
</p>
<p>
<label for="distance">Distance (km): </label>
<input type="text" name="distance" id="distance" readonly="true" />
</p>
</div>
<div id="map_canvas"></div>

</body>
</html>